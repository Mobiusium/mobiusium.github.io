<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mobi's Ping Pong Scorer</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Smiley+Sans:wght@400;700&display=swap');
    body {
      font-family: 'Smiley Sans', Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0;
      padding: 20px;
      background-color: #f4f4f9;
    }
    h1 {
      color: #333;
    }
    .scoreboard {
      display: flex;
      justify-content: center;
      gap: 50px;
      margin-top: 20px;
    }
    .player {
      text-align: center;
    }
    .player-title {
      cursor: pointer; /* Indicate that the title is clickable */
      font-weight: bold; /* Make player title bold */
    }
    .player-score {
      font-size: 72px; /* Increase font size */
      width: 100px; /* Fixed width for square */
      height: 100px; /* Fixed height for square */
      margin: 10px 0;
      padding: 10px;
      border: 3px solid black; /* Black border for score */
      border-radius: 8px;
      display: flex; /* Use flex to center text */
      justify-content: center; /* Center text horizontally */
      align-items: center; /* Center text vertically */
      user-select: none; /* Prevent text selection */
    }
    .serving {
      border-color: #007bff; /* Blue serving indicator */
    }
    .winner {
      border-color: green; /* Green border for winning player */
      background-color: #d4edda; /* Light green background for winning player */
      cursor: default; /* Prevent user from selecting score */
    }
    .buttons {
      margin-top: 20px;
      display: flex;
      gap: 10px;
    }
    .info {
      margin-top: 20px;
      font-size: 18px;
      min-height: 24px; /* Ensure space for "Deuce" message */
    }
    .settings {
      margin-top: 40px; /* Space above settings */
      text-align: center; /* Center align settings */
    }
    .winning-points {
      display: flex;
      align-items: center; /* Center items vertically */
      gap: 10px; /* Space between input and buttons */
    }
    input[type="number"] {
      width: 60px; /* Make input shorter */
    }
    .buttons button {
      background-color: white; /* White background */
      color: black; /* Black text */
      border: 2px solid black; /* Black border */
      padding: 10px 20px; /* Add padding */
      font-size: 16px; /* Increase font size */
      font-family: 'Smiley Sans', Arial, sans-serif; /* Use Smiley Sans font */
      border-radius: 5px; /* Rounded corners */
      cursor: pointer; /* Pointer cursor on hover */
      transition: background-color 0.3s, color 0.3s; /* Smooth transition */
    }

    .buttons button:hover {
      background-color: black; /* Black background on hover */
      color: white; /* White text on hover */
    }
  </style>
</head>
<body>
  <h1>Mobi's Ping Pong Scorer</h1>

  <!-- Scoreboard -->
  <div class="scoreboard">
    <div class="player" id="player1">
      <h2 class="player-title" onclick="changeInitialServer(1)">Player 1</h2>
      <div class="player-score" id="score1" onclick="addPoint(1)">0</div>
    </div>
    <div class="player" id="player2">
      <h2 class="player-title" onclick="changeInitialServer(2)">Player 2</h2>
      <div class="player-score" id="score2" onclick="addPoint(2)">0</div>
    </div>
  </div>

  <!-- Information Display -->
  <div class="info" id="win-info"></div>

  <!-- Control Buttons -->
  <div class="buttons">
    <button onclick="resetGame()">Reset Game</button>
  </div>

  <!-- Settings Section -->
  <div class="settings">
    <div class="winning-points">
      <label for="winning-points">Winning Points</label>
      <input type="range" id="winning-points" min="7" max="11" value="7" step="1" oninput="updateWinningPointsLabel(this.value)">
      <span id="winning-points-label">7</span>
    </div>
  </div>

  <script>
    let score1 = 0;
    let score2 = 0;
    let serveTurn = 1;
    let serveCount = 0;
    let winningPoints = 7;
    let isDeuce = false; // Track if the game is in deuce
    const winInfo = document.getElementById('win-info');
    let gameActive = true; // Track if the game is active

    // Update winning points label when slider value changes
    function updateWinningPointsLabel(value) {
      document.getElementById('winning-points-label').textContent = value;
      winningPoints = parseInt(value);
      resetGame();
    }

    // Set winning points based on user input
    document.getElementById('winning-points').addEventListener('change', function() {
      winningPoints = parseInt(this.value);
      resetGame();
    });

    // Change the initial server when player title is clicked
    function changeInitialServer(player) {
      if (score1 === 0 && score2 === 0) {
        serveTurn = player;
        updateServeIndicator();
      }
    }

    function addPoint(player) {
      if (!gameActive) return; // Prevent adding points if game is over
      if (player === 1) score1++;
      else score2++;

      updateScores();
      checkServe();
      checkWinner();
    }

    function updateScores() {
      document.getElementById('score1').textContent = score1;
      document.getElementById('score2').textContent = score2;
    }

    function checkServe() {
      let totalPoints = score1 + score2;

      // Check if itâ€™s deuce
      if (score1 >= winningPoints - 1 && score2 >= winningPoints - 1 && score1 === score2) {
        isDeuce = true; // Enter deuce state
        winInfo.textContent = "Deuce";
        serveTurn = totalPoints % 2 === 0 ? 1 : 2; // Switch serve every 1 point in deuce
        serveCount = 0;
      } else if (isDeuce) {
        winInfo.textContent = "Deuce"; // Keep deuce displayed
        serveTurn = totalPoints % 2 === 0 ? 1 : 2; // Switch serve every 1 point in deuce
      } else {
        winInfo.textContent = ""; // Clear deuce message
        if (serveCount >= 2) { // Switch serve every 2 points before deuce
          serveTurn = serveTurn === 1 ? 2 : 1;
          serveCount = 0;
        }
      }

      serveCount++;
      updateServeIndicator();
    }

    function updateServeIndicator() {
      document.getElementById('score1').classList.toggle('serving', serveTurn === 1);
      document.getElementById('score2').classList.toggle('serving', serveTurn === 2);
    }

    function checkWinner() {
      if (score1 >= winningPoints && score1 - score2 >= 2) {
        declareWinner(1);
      } else if (score2 >= winningPoints && score2 - score1 >= 2) {
        declareWinner(2);
      }
    }

    function declareWinner(winner) {
      // Apply winning styles
      if (winner === 1) {
        document.getElementById('score1').classList.add('winner');
        document.getElementById('score2').classList.remove('winner');
      } else {
        document.getElementById('score2').classList.add('winner');
        document.getElementById('score1').classList.remove('winner');
      }
      winInfo.textContent = ""; // Clear win info
      gameActive = false; // Mark game as inactive
      disableServeIndicator(); // Turn off the serve indicator
    }

    function disableServeIndicator() {
      document.getElementById('score1').classList.remove('serving');
      document.getElementById('score2').classList.remove('serving');
    }

    function resetGame() {
      score1 = 0;
      score2 = 0;
      serveCount = 0;
      isDeuce = false; // Reset deuce state
      winInfo.textContent = "";
      serveTurn = 1; // Reset to Player 1 as initial server
      updateScores();
      updateServeIndicator();

      // Remove winner styles
      document.getElementById('score1').classList.remove('winner');
      document.getElementById('score2').classList.remove('winner');

      // Re-enable game
      gameActive = true; // Reset game active state
      enableGame();
    }

    function enableGame() {
      document.querySelectorAll('.player-score').forEach(score => {
        score.style.cursor = 'pointer'; // Allow score to be clickable
      });
    }

    function disableGame() {
      document.querySelectorAll('.player-score').forEach(score => {
        score.style.cursor = 'default'; // Prevent selection of the score
      });
    }

    // Initialize the serve indicator when the page loads
    window.onload = function() {
      serveTurn = 1; // Default to Player 1
      updateServeIndicator();
    };
  </script>
</body>
</html>
